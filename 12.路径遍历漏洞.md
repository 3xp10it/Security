#12.路径遍历漏洞

  这是开发人员在实现下载功能的时候很容易引入的一个漏洞。我曾经利用该漏洞渗透两个系统，纯手工，前后不到十分钟就把两个操作系统的root权限擒下了。这应该高度引起开发人员的注意，而实际上，却没几开发人员有意识去避免这些漏洞的产生。
  
  以下这段代码用于实现文件下载，当然，这段代码是有严重漏洞的。（希望你开发的系统中没有类似的实现）
  
```java
String fileName = request.getParameter("file");
File file = new File("C://download/" + fileName);

int len = 0;
byte[] buffer = new byte[1024 * 4];
InputStream input = new FileInputStream(file);
while ((len = input.read(buffer)) != -1) {
	response.getOutputStream().write(buffer, 0, len);
}

response.getOutputStream().flush();
input.close();
```

##参考资料

 * https://www.owasp.org/index.php/Path_Traversal
 * https://www.owasp.org/index.php/File_System#Path_traversal
 * https://www.owasp.org/index.php/Resource_Injection
 * https://www.owasp.org/index.php/Relative_Path_Traversal
 * https://www.owasp.org/index.php/Path_Manipulation
 * https://www.owasp.org/index.php/Testing_for_Path_Traversal_(OWASP-AZ-001)

